'use strict';var cov_ql1ilge0b=function(){var path="/home/somto/1Projects/mentorship project/StackOverflow-lite/server/server/controllers/utilities/errorHandler.js",hash="654b7f829ea6e1613e65d3343f2f5b844e2df8c1",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/home/somto/1Projects/mentorship project/StackOverflow-lite/server/server/controllers/utilities/errorHandler.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:18},end:{line:7,column:58}},"2":{start:{line:9,column:19},end:{line:9,column:54}},"3":{start:{line:11,column:39},end:{line:11,column:93}},"4":{start:{line:13,column:11},end:{line:13,column:44}},"5":{start:{line:14,column:17},end:{line:14,column:24}},"6":{start:{line:16,column:19},end:{line:59,column:1}},"7":{start:{line:18,column:4},end:{line:18,column:46}},"8":{start:{line:18,column:18},end:{line:18,column:46}},"9":{start:{line:19,column:4},end:{line:19,column:39}},"10":{start:{line:22,column:4},end:{line:22,column:46}},"11":{start:{line:22,column:18},end:{line:22,column:46}},"12":{start:{line:23,column:4},end:{line:23,column:65}},"13":{start:{line:27,column:4},end:{line:27,column:92}},"14":{start:{line:31,column:4},end:{line:31,column:88}},"15":{start:{line:34,column:4},end:{line:34,column:46}},"16":{start:{line:34,column:18},end:{line:34,column:46}},"17":{start:{line:35,column:4},end:{line:35,column:72}},"18":{start:{line:38,column:4},end:{line:38,column:46}},"19":{start:{line:38,column:18},end:{line:38,column:46}},"20":{start:{line:39,column:4},end:{line:39,column:69}},"21":{start:{line:42,column:4},end:{line:42,column:46}},"22":{start:{line:42,column:18},end:{line:42,column:46}},"23":{start:{line:43,column:4},end:{line:43,column:69}},"24":{start:{line:46,column:4},end:{line:46,column:46}},"25":{start:{line:46,column:18},end:{line:46,column:46}},"26":{start:{line:47,column:4},end:{line:47,column:72}},"27":{start:{line:50,column:4},end:{line:50,column:46}},"28":{start:{line:50,column:18},end:{line:50,column:46}},"29":{start:{line:51,column:4},end:{line:51,column:88}},"30":{start:{line:54,column:4},end:{line:54,column:80}},"31":{start:{line:57,column:4},end:{line:57,column:91}},"32":{start:{line:61,column:0},end:{line:61,column:31}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:11,column:9},end:{line:11,column:31}},loc:{start:{line:11,column:37},end:{line:11,column:95}},line:11},"1":{name:"createHandlerError",decl:{start:{line:17,column:31},end:{line:17,column:49}},loc:{start:{line:17,column:72},end:{line:20,column:3}},line:17},"2":{name:"incompleteFieldHandlerError",decl:{start:{line:21,column:40},end:{line:21,column:67}},loc:{start:{line:21,column:83},end:{line:24,column:3}},line:21},"3":{name:"fileTypeHandleError",decl:{start:{line:25,column:32},end:{line:25,column:51}},loc:{start:{line:25,column:57},end:{line:28,column:3}},line:25},"4":{name:"fileSizeHandleError",decl:{start:{line:29,column:32},end:{line:29,column:51}},loc:{start:{line:29,column:57},end:{line:32,column:3}},line:29},"5":{name:"usernameHandlerError",decl:{start:{line:33,column:33},end:{line:33,column:53}},loc:{start:{line:33,column:69},end:{line:36,column:3}},line:33},"6":{name:"emailHandlerError",decl:{start:{line:37,column:30},end:{line:37,column:47}},loc:{start:{line:37,column:63},end:{line:40,column:3}},line:37},"7":{name:"phoneHandlerError",decl:{start:{line:41,column:30},end:{line:41,column:47}},loc:{start:{line:41,column:63},end:{line:44,column:3}},line:41},"8":{name:"questionHandlerError",decl:{start:{line:45,column:33},end:{line:45,column:53}},loc:{start:{line:45,column:69},end:{line:48,column:3}},line:45},"9":{name:"userNotPrestentHandlerError",decl:{start:{line:49,column:40},end:{line:49,column:67}},loc:{start:{line:49,column:83},end:{line:52,column:3}},line:49},"10":{name:"noTokenHandlerError",decl:{start:{line:53,column:32},end:{line:53,column:51}},loc:{start:{line:53,column:57},end:{line:55,column:3}},line:53},"11":{name:"failedAuthHandlerError",decl:{start:{line:56,column:35},end:{line:56,column:57}},loc:{start:{line:56,column:63},end:{line:58,column:3}},line:56}},branchMap:{"0":{loc:{start:{line:11,column:46},end:{line:11,column:92}},type:"cond-expr",locations:[{start:{line:11,column:70},end:{line:11,column:73}},{start:{line:11,column:76},end:{line:11,column:92}}],line:11},"1":{loc:{start:{line:11,column:46},end:{line:11,column:67}},type:"binary-expr",locations:[{start:{line:11,column:46},end:{line:11,column:49}},{start:{line:11,column:53},end:{line:11,column:67}}],line:11},"2":{loc:{start:{line:18,column:4},end:{line:18,column:46}},type:"if",locations:[{start:{line:18,column:4},end:{line:18,column:46}},{start:{line:18,column:4},end:{line:18,column:46}}],line:18},"3":{loc:{start:{line:22,column:4},end:{line:22,column:46}},type:"if",locations:[{start:{line:22,column:4},end:{line:22,column:46}},{start:{line:22,column:4},end:{line:22,column:46}}],line:22},"4":{loc:{start:{line:34,column:4},end:{line:34,column:46}},type:"if",locations:[{start:{line:34,column:4},end:{line:34,column:46}},{start:{line:34,column:4},end:{line:34,column:46}}],line:34},"5":{loc:{start:{line:38,column:4},end:{line:38,column:46}},type:"if",locations:[{start:{line:38,column:4},end:{line:38,column:46}},{start:{line:38,column:4},end:{line:38,column:46}}],line:38},"6":{loc:{start:{line:42,column:4},end:{line:42,column:46}},type:"if",locations:[{start:{line:42,column:4},end:{line:42,column:46}},{start:{line:42,column:4},end:{line:42,column:46}}],line:42},"7":{loc:{start:{line:46,column:4},end:{line:46,column:46}},type:"if",locations:[{start:{line:46,column:4},end:{line:46,column:46}},{start:{line:46,column:4},end:{line:46,column:46}}],line:46},"8":{loc:{start:{line:50,column:4},end:{line:50,column:46}},type:"if",locations:[{start:{line:50,column:4},end:{line:50,column:46}},{start:{line:50,column:4},end:{line:50,column:46}}],line:50}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},_coverageSchema:"d34fc3e6b8297bcde183f5492bcb8fcb36775295"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_ql1ilge0b.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _fileSystem=(cov_ql1ilge0b.s[1]++,require('../../../utilities/fileSystem'));var _fileSystem2=(cov_ql1ilge0b.s[2]++,_interopRequireDefault(_fileSystem));function _interopRequireDefault(obj){cov_ql1ilge0b.f[0]++;cov_ql1ilge0b.s[3]++;return(cov_ql1ilge0b.b[1][0]++,obj)&&(cov_ql1ilge0b.b[1][1]++,obj.__esModule)?(cov_ql1ilge0b.b[0][0]++,obj):(cov_ql1ilge0b.b[0][1]++,{default:obj});}var _ref=(cov_ql1ilge0b.s[4]++,[_fileSystem2.default.deleteFile]),deleteFile=(cov_ql1ilge0b.s[5]++,_ref[0]);// Delete file helper method
var errorHandler=(cov_ql1ilge0b.s[6]++,{createHandlerError:function createHandlerError(error,res,filePath){cov_ql1ilge0b.f[1]++;cov_ql1ilge0b.s[7]++;if(filePath){cov_ql1ilge0b.b[2][0]++;cov_ql1ilge0b.s[8]++;deleteFile('./'+filePath);}else{cov_ql1ilge0b.b[2][1]++;}// if file uploads delete it
cov_ql1ilge0b.s[9]++;return res.status(400).send(error);},incompleteFieldHandlerError:function incompleteFieldHandlerError(res,filePath){cov_ql1ilge0b.f[2]++;cov_ql1ilge0b.s[10]++;if(filePath){cov_ql1ilge0b.b[3][0]++;cov_ql1ilge0b.s[11]++;deleteFile('./'+filePath);}else{cov_ql1ilge0b.b[3][1]++;}// if file uploads delete it
cov_ql1ilge0b.s[12]++;return res.status(206).send({message:'Incomplete field'});},fileTypeHandleError:function fileTypeHandleError(res){cov_ql1ilge0b.f[3]++;cov_ql1ilge0b.s[13]++;// file type handleError
res.status(403).json({message:'Only .png and .jpg files are allowed!',error:true});},fileSizeHandleError:function fileSizeHandleError(res){cov_ql1ilge0b.f[4]++;cov_ql1ilge0b.s[14]++;// file size handleError
res.status(403).json({message:'file should not be more than 2mb!',error:true});},usernameHandlerError:function usernameHandlerError(res,filePath){cov_ql1ilge0b.f[5]++;cov_ql1ilge0b.s[15]++;if(filePath){cov_ql1ilge0b.b[4][0]++;cov_ql1ilge0b.s[16]++;deleteFile('./'+filePath);}else{cov_ql1ilge0b.b[4][1]++;}// if file uploads delete it
cov_ql1ilge0b.s[17]++;return res.status(400).send({message:'username already exists'});},emailHandlerError:function emailHandlerError(res,filePath){cov_ql1ilge0b.f[6]++;cov_ql1ilge0b.s[18]++;if(filePath){cov_ql1ilge0b.b[5][0]++;cov_ql1ilge0b.s[19]++;deleteFile('./'+filePath);}else{cov_ql1ilge0b.b[5][1]++;}// if file uploads delete it
cov_ql1ilge0b.s[20]++;return res.status(400).send({message:'email already exists'});},phoneHandlerError:function phoneHandlerError(res,filePath){cov_ql1ilge0b.f[7]++;cov_ql1ilge0b.s[21]++;if(filePath){cov_ql1ilge0b.b[6][0]++;cov_ql1ilge0b.s[22]++;deleteFile('./'+filePath);}else{cov_ql1ilge0b.b[6][1]++;}// if file uploads delete it
cov_ql1ilge0b.s[23]++;return res.status(400).send({message:'phone already exists'});},questionHandlerError:function questionHandlerError(res,filePath){cov_ql1ilge0b.f[8]++;cov_ql1ilge0b.s[24]++;if(filePath){cov_ql1ilge0b.b[7][0]++;cov_ql1ilge0b.s[25]++;deleteFile('./'+filePath);}else{cov_ql1ilge0b.b[7][1]++;}// if file uploads delete it
cov_ql1ilge0b.s[26]++;return res.status(400).send({message:'question already exists'});},userNotPrestentHandlerError:function userNotPrestentHandlerError(res,filePath){cov_ql1ilge0b.f[9]++;cov_ql1ilge0b.s[27]++;if(filePath){cov_ql1ilge0b.b[8][0]++;cov_ql1ilge0b.s[28]++;deleteFile('./'+filePath);}else{cov_ql1ilge0b.b[8][1]++;}// if file uploads delete it
cov_ql1ilge0b.s[29]++;return res.status(400).send({message:'user has been removed from the database'});},noTokenHandlerError:function noTokenHandlerError(res){cov_ql1ilge0b.f[10]++;cov_ql1ilge0b.s[30]++;return res.status(401).send({auth:false,message:'No token provided.'});},failedAuthHandlerError:function failedAuthHandlerError(res){cov_ql1ilge0b.f[11]++;cov_ql1ilge0b.s[31]++;return res.status(500).send({auth:false,message:'Failed to authenticate token.'});}});cov_ql1ilge0b.s[32]++;exports.default=errorHandler;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVycm9ySGFuZGxlci5qcyJdLCJuYW1lcyI6WyJmc0hlbHBlciIsImRlbGV0ZUZpbGUiLCJlcnJvckhhbmRsZXIiLCJjcmVhdGVIYW5kbGVyRXJyb3IiLCJlcnJvciIsInJlcyIsImZpbGVQYXRoIiwic3RhdHVzIiwic2VuZCIsImluY29tcGxldGVGaWVsZEhhbmRsZXJFcnJvciIsIm1lc3NhZ2UiLCJmaWxlVHlwZUhhbmRsZUVycm9yIiwianNvbiIsImZpbGVTaXplSGFuZGxlRXJyb3IiLCJ1c2VybmFtZUhhbmRsZXJFcnJvciIsImVtYWlsSGFuZGxlckVycm9yIiwicGhvbmVIYW5kbGVyRXJyb3IiLCJxdWVzdGlvbkhhbmRsZXJFcnJvciIsInVzZXJOb3RQcmVzdGVudEhhbmRsZXJFcnJvciIsIm5vVG9rZW5IYW5kbGVyRXJyb3IiLCJhdXRoIiwiZmFpbGVkQXV0aEhhbmRsZXJFcnJvciJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7Ozs7OztXQUVxQixDQUFDQSxxQkFBU0MsVUFBVixDO0lBQWRBLFUsWUFBb0M7O0FBRTNDLElBQU1DLGVBQWU7QUFDbkJDLG9CQURtQiw4QkFDQUMsS0FEQSxFQUNPQyxHQURQLEVBQ1lDLFFBRFosRUFDc0I7QUFDdkMsUUFBSUEsUUFBSixFQUFjTCxrQkFBZ0JLLFFBQWhCLEVBRHlCLENBQ0k7QUFDM0MsV0FBT0QsSUFBSUUsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCSixLQUFyQixDQUFQO0FBQ0QsR0FKa0I7QUFLbkJLLDZCQUxtQix1Q0FLU0osR0FMVCxFQUtjQyxRQUxkLEVBS3dCO0FBQ3pDLFFBQUlBLFFBQUosRUFBY0wsa0JBQWdCSyxRQUFoQixFQUQyQixDQUNFO0FBQzNDLFdBQU9ELElBQUlFLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQixFQUFFRSxTQUFTLGtCQUFYLEVBQXJCLENBQVA7QUFDRCxHQVJrQjtBQVNuQkMscUJBVG1CLCtCQVNDTixHQVRELEVBU007QUFBRTtBQUN6QkEsUUFBSUUsTUFBSixDQUFXLEdBQVgsRUFBZ0JLLElBQWhCLENBQXFCLEVBQUVGLFNBQVMsdUNBQVgsRUFBb0ROLE9BQU8sSUFBM0QsRUFBckI7QUFDRCxHQVhrQjtBQVluQlMscUJBWm1CLCtCQVlDUixHQVpELEVBWU07QUFBRTtBQUN6QkEsUUFBSUUsTUFBSixDQUFXLEdBQVgsRUFBZ0JLLElBQWhCLENBQXFCLEVBQUVGLFNBQVMsbUNBQVgsRUFBZ0ROLE9BQU8sSUFBdkQsRUFBckI7QUFDRCxHQWRrQjtBQWVuQlUsc0JBZm1CLGdDQWVFVCxHQWZGLEVBZU9DLFFBZlAsRUFlaUI7QUFDbEMsUUFBSUEsUUFBSixFQUFjTCxrQkFBZ0JLLFFBQWhCLEVBRG9CLENBQ1M7QUFDM0MsV0FBT0QsSUFBSUUsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLEVBQUVFLFNBQVMseUJBQVgsRUFBckIsQ0FBUDtBQUNELEdBbEJrQjtBQW1CbkJLLG1CQW5CbUIsNkJBbUJEVixHQW5CQyxFQW1CSUMsUUFuQkosRUFtQmM7QUFDL0IsUUFBSUEsUUFBSixFQUFjTCxrQkFBZ0JLLFFBQWhCLEVBRGlCLENBQ1k7QUFDM0MsV0FBT0QsSUFBSUUsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLEVBQUVFLFNBQVMsc0JBQVgsRUFBckIsQ0FBUDtBQUNELEdBdEJrQjtBQXVCbkJNLG1CQXZCbUIsNkJBdUJEWCxHQXZCQyxFQXVCSUMsUUF2QkosRUF1QmM7QUFDL0IsUUFBSUEsUUFBSixFQUFjTCxrQkFBZ0JLLFFBQWhCLEVBRGlCLENBQ1k7QUFDM0MsV0FBT0QsSUFBSUUsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLEVBQUVFLFNBQVMsc0JBQVgsRUFBckIsQ0FBUDtBQUNELEdBMUJrQjtBQTJCbkJPLHNCQTNCbUIsZ0NBMkJFWixHQTNCRixFQTJCT0MsUUEzQlAsRUEyQmlCO0FBQ2xDLFFBQUlBLFFBQUosRUFBY0wsa0JBQWdCSyxRQUFoQixFQURvQixDQUNTO0FBQzNDLFdBQU9ELElBQUlFLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQixFQUFFRSxTQUFTLHlCQUFYLEVBQXJCLENBQVA7QUFDRCxHQTlCa0I7QUErQm5CUSw2QkEvQm1CLHVDQStCU2IsR0EvQlQsRUErQmNDLFFBL0JkLEVBK0J3QjtBQUN6QyxRQUFJQSxRQUFKLEVBQWNMLGtCQUFnQkssUUFBaEIsRUFEMkIsQ0FDRTtBQUMzQyxXQUFPRCxJQUFJRSxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUIsRUFBRUUsU0FBUyx5Q0FBWCxFQUFyQixDQUFQO0FBQ0QsR0FsQ2tCO0FBbUNuQlMscUJBbkNtQiwrQkFtQ0NkLEdBbkNELEVBbUNNO0FBQ3ZCLFdBQU9BLElBQUlFLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQixFQUFFWSxNQUFNLEtBQVIsRUFBZVYsU0FBUyxvQkFBeEIsRUFBckIsQ0FBUDtBQUNELEdBckNrQjtBQXNDbkJXLHdCQXRDbUIsa0NBc0NJaEIsR0F0Q0osRUFzQ1M7QUFDMUIsV0FBT0EsSUFBSUUsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLEVBQUVZLE1BQU0sS0FBUixFQUFlVixTQUFTLCtCQUF4QixFQUFyQixDQUFQO0FBQ0Q7QUF4Q2tCLENBQXJCOztrQkEyQ2VSLFkiLCJmaWxlIjoiZXJyb3JIYW5kbGVyLmpzIiwic291cmNlUm9vdCI6Ii9ob21lL3NvbXRvLzFQcm9qZWN0cy9tZW50b3JzaGlwIHByb2plY3QvU3RhY2tPdmVyZmxvdy1saXRlL3NlcnZlci9zZXJ2ZXIvY29udHJvbGxlcnMvdXRpbGl0aWVzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZzSGVscGVyIGZyb20gJy4uLy4uLy4uL3V0aWxpdGllcy9maWxlU3lzdGVtJztcblxuY29uc3QgW2RlbGV0ZUZpbGVdID0gW2ZzSGVscGVyLmRlbGV0ZUZpbGVdOy8vIERlbGV0ZSBmaWxlIGhlbHBlciBtZXRob2RcblxuY29uc3QgZXJyb3JIYW5kbGVyID0ge1xuICBjcmVhdGVIYW5kbGVyRXJyb3IoZXJyb3IsIHJlcywgZmlsZVBhdGgpIHtcbiAgICBpZiAoZmlsZVBhdGgpIGRlbGV0ZUZpbGUoYC4vJHtmaWxlUGF0aH1gKTsgLy8gaWYgZmlsZSB1cGxvYWRzIGRlbGV0ZSBpdFxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChlcnJvcik7XG4gIH0sXG4gIGluY29tcGxldGVGaWVsZEhhbmRsZXJFcnJvcihyZXMsIGZpbGVQYXRoKSB7XG4gICAgaWYgKGZpbGVQYXRoKSBkZWxldGVGaWxlKGAuLyR7ZmlsZVBhdGh9YCk7IC8vIGlmIGZpbGUgdXBsb2FkcyBkZWxldGUgaXRcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDYpLnNlbmQoeyBtZXNzYWdlOiAnSW5jb21wbGV0ZSBmaWVsZCcgfSk7XG4gIH0sXG4gIGZpbGVUeXBlSGFuZGxlRXJyb3IocmVzKSB7IC8vIGZpbGUgdHlwZSBoYW5kbGVFcnJvclxuICAgIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgbWVzc2FnZTogJ09ubHkgLnBuZyBhbmQgLmpwZyBmaWxlcyBhcmUgYWxsb3dlZCEnLCBlcnJvcjogdHJ1ZSB9KTtcbiAgfSxcbiAgZmlsZVNpemVIYW5kbGVFcnJvcihyZXMpIHsgLy8gZmlsZSBzaXplIGhhbmRsZUVycm9yXG4gICAgcmVzLnN0YXR1cyg0MDMpLmpzb24oeyBtZXNzYWdlOiAnZmlsZSBzaG91bGQgbm90IGJlIG1vcmUgdGhhbiAybWIhJywgZXJyb3I6IHRydWUgfSk7XG4gIH0sXG4gIHVzZXJuYW1lSGFuZGxlckVycm9yKHJlcywgZmlsZVBhdGgpIHtcbiAgICBpZiAoZmlsZVBhdGgpIGRlbGV0ZUZpbGUoYC4vJHtmaWxlUGF0aH1gKTsgLy8gaWYgZmlsZSB1cGxvYWRzIGRlbGV0ZSBpdFxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IG1lc3NhZ2U6ICd1c2VybmFtZSBhbHJlYWR5IGV4aXN0cycgfSk7XG4gIH0sXG4gIGVtYWlsSGFuZGxlckVycm9yKHJlcywgZmlsZVBhdGgpIHtcbiAgICBpZiAoZmlsZVBhdGgpIGRlbGV0ZUZpbGUoYC4vJHtmaWxlUGF0aH1gKTsgLy8gaWYgZmlsZSB1cGxvYWRzIGRlbGV0ZSBpdFxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IG1lc3NhZ2U6ICdlbWFpbCBhbHJlYWR5IGV4aXN0cycgfSk7XG4gIH0sXG4gIHBob25lSGFuZGxlckVycm9yKHJlcywgZmlsZVBhdGgpIHtcbiAgICBpZiAoZmlsZVBhdGgpIGRlbGV0ZUZpbGUoYC4vJHtmaWxlUGF0aH1gKTsgLy8gaWYgZmlsZSB1cGxvYWRzIGRlbGV0ZSBpdFxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IG1lc3NhZ2U6ICdwaG9uZSBhbHJlYWR5IGV4aXN0cycgfSk7XG4gIH0sXG4gIHF1ZXN0aW9uSGFuZGxlckVycm9yKHJlcywgZmlsZVBhdGgpIHtcbiAgICBpZiAoZmlsZVBhdGgpIGRlbGV0ZUZpbGUoYC4vJHtmaWxlUGF0aH1gKTsgLy8gaWYgZmlsZSB1cGxvYWRzIGRlbGV0ZSBpdFxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IG1lc3NhZ2U6ICdxdWVzdGlvbiBhbHJlYWR5IGV4aXN0cycgfSk7XG4gIH0sXG4gIHVzZXJOb3RQcmVzdGVudEhhbmRsZXJFcnJvcihyZXMsIGZpbGVQYXRoKSB7XG4gICAgaWYgKGZpbGVQYXRoKSBkZWxldGVGaWxlKGAuLyR7ZmlsZVBhdGh9YCk7IC8vIGlmIGZpbGUgdXBsb2FkcyBkZWxldGUgaXRcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoeyBtZXNzYWdlOiAndXNlciBoYXMgYmVlbiByZW1vdmVkIGZyb20gdGhlIGRhdGFiYXNlJyB9KTtcbiAgfSxcbiAgbm9Ub2tlbkhhbmRsZXJFcnJvcihyZXMpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLnNlbmQoeyBhdXRoOiBmYWxzZSwgbWVzc2FnZTogJ05vIHRva2VuIHByb3ZpZGVkLicgfSk7XG4gIH0sXG4gIGZhaWxlZEF1dGhIYW5kbGVyRXJyb3IocmVzKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgYXV0aDogZmFsc2UsIG1lc3NhZ2U6ICdGYWlsZWQgdG8gYXV0aGVudGljYXRlIHRva2VuLicgfSk7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IGVycm9ySGFuZGxlcjtcbiJdfQ==