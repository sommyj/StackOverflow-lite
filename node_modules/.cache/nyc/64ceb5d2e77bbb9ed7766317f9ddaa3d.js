'use strict';var cov_ql1ilge0b=function(){var path="/home/somto/1Projects/mentorship project/StackOverflow-lite/server/server/controllers/utilities/errorHandler.js",hash="6fa749985cea07e63b7346e3d993fa9cfcc715db",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/home/somto/1Projects/mentorship project/StackOverflow-lite/server/server/controllers/utilities/errorHandler.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:18},end:{line:7,column:58}},"2":{start:{line:9,column:19},end:{line:9,column:54}},"3":{start:{line:11,column:23},end:{line:11,column:51}},"4":{start:{line:13,column:24},end:{line:13,column:64}},"5":{start:{line:15,column:39},end:{line:15,column:93}},"6":{start:{line:17,column:11},end:{line:17,column:44}},"7":{start:{line:18,column:17},end:{line:18,column:24}},"8":{start:{line:20,column:12},end:{line:20,column:62}},"9":{start:{line:21,column:29},end:{line:21,column:37}},"10":{start:{line:25,column:15},end:{line:27,column:1}},"11":{start:{line:26,column:2},end:{line:26,column:38}},"12":{start:{line:29,column:14},end:{line:31,column:1}},"13":{start:{line:30,column:2},end:{line:30,column:40}},"14":{start:{line:33,column:19},end:{line:75,column:1}},"15":{start:{line:35,column:4},end:{line:35,column:51}},"16":{start:{line:35,column:18},end:{line:35,column:51}},"17":{start:{line:36,column:4},end:{line:36,column:39}},"18":{start:{line:39,column:4},end:{line:39,column:71}},"19":{start:{line:42,column:4},end:{line:42,column:65}},"20":{start:{line:46,column:4},end:{line:46,column:67}},"21":{start:{line:49,column:4},end:{line:49,column:72}},"22":{start:{line:52,column:4},end:{line:52,column:69}},"23":{start:{line:55,column:4},end:{line:55,column:69}},"24":{start:{line:58,column:4},end:{line:58,column:72}},"25":{start:{line:61,column:4},end:{line:61,column:51}},"26":{start:{line:61,column:18},end:{line:61,column:51}},"27":{start:{line:62,column:4},end:{line:62,column:88}},"28":{start:{line:65,column:4},end:{line:65,column:80}},"29":{start:{line:68,column:4},end:{line:68,column:91}},"30":{start:{line:71,column:4},end:{line:73,column:5}},"31":{start:{line:72,column:6},end:{line:72,column:18}},"32":{start:{line:73,column:5},end:{line:73,column:18}},"33":{start:{line:77,column:0},end:{line:77,column:31}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:15,column:9},end:{line:15,column:31}},loc:{start:{line:15,column:37},end:{line:15,column:95}},line:15},"1":{name:"isNumber",decl:{start:{line:25,column:24},end:{line:25,column:32}},loc:{start:{line:25,column:36},end:{line:27,column:1}},line:25},"2":{name:"isFloat",decl:{start:{line:29,column:23},end:{line:29,column:30}},loc:{start:{line:29,column:34},end:{line:31,column:1}},line:29},"3":{name:"createHandlerError",decl:{start:{line:34,column:31},end:{line:34,column:49}},loc:{start:{line:34,column:72},end:{line:37,column:3}},line:34},"4":{name:"notFoundHandlerError",decl:{start:{line:38,column:33},end:{line:38,column:53}},loc:{start:{line:38,column:70},end:{line:40,column:3}},line:38},"5":{name:"incompleteFieldHandlerError",decl:{start:{line:41,column:40},end:{line:41,column:67}},loc:{start:{line:41,column:73},end:{line:43,column:3}},line:41},"6":{name:"fileHandleError",decl:{start:{line:44,column:28},end:{line:44,column:43}},loc:{start:{line:44,column:58},end:{line:47,column:3}},line:44},"7":{name:"usernameHandlerError",decl:{start:{line:48,column:33},end:{line:48,column:53}},loc:{start:{line:48,column:59},end:{line:50,column:3}},line:48},"8":{name:"emailHandlerError",decl:{start:{line:51,column:30},end:{line:51,column:47}},loc:{start:{line:51,column:53},end:{line:53,column:3}},line:51},"9":{name:"phoneHandlerError",decl:{start:{line:54,column:30},end:{line:54,column:47}},loc:{start:{line:54,column:53},end:{line:56,column:3}},line:54},"10":{name:"questionHandlerError",decl:{start:{line:57,column:33},end:{line:57,column:53}},loc:{start:{line:57,column:59},end:{line:59,column:3}},line:57},"11":{name:"userNotPrestentHandlerError",decl:{start:{line:60,column:40},end:{line:60,column:67}},loc:{start:{line:60,column:83},end:{line:63,column:3}},line:60},"12":{name:"noTokenHandlerError",decl:{start:{line:64,column:32},end:{line:64,column:51}},loc:{start:{line:64,column:57},end:{line:66,column:3}},line:64},"13":{name:"failedAuthHandlerError",decl:{start:{line:67,column:35},end:{line:67,column:57}},loc:{start:{line:67,column:63},end:{line:69,column:3}},line:67},"14":{name:"parametersHandlerError",decl:{start:{line:70,column:35},end:{line:70,column:57}},loc:{start:{line:70,column:63},end:{line:74,column:3}},line:70}},branchMap:{"0":{loc:{start:{line:15,column:46},end:{line:15,column:92}},type:"cond-expr",locations:[{start:{line:15,column:70},end:{line:15,column:73}},{start:{line:15,column:76},end:{line:15,column:92}}],line:15},"1":{loc:{start:{line:15,column:46},end:{line:15,column:67}},type:"binary-expr",locations:[{start:{line:15,column:46},end:{line:15,column:49}},{start:{line:15,column:53},end:{line:15,column:67}}],line:15},"2":{loc:{start:{line:30,column:9},end:{line:30,column:39}},type:"binary-expr",locations:[{start:{line:30,column:9},end:{line:30,column:24}},{start:{line:30,column:28},end:{line:30,column:39}}],line:30},"3":{loc:{start:{line:35,column:4},end:{line:35,column:51}},type:"if",locations:[{start:{line:35,column:4},end:{line:35,column:51}},{start:{line:35,column:4},end:{line:35,column:51}}],line:35},"4":{loc:{start:{line:61,column:4},end:{line:61,column:51}},type:"if",locations:[{start:{line:61,column:4},end:{line:61,column:51}},{start:{line:61,column:4},end:{line:61,column:51}}],line:61},"5":{loc:{start:{line:71,column:4},end:{line:73,column:5}},type:"if",locations:[{start:{line:71,column:4},end:{line:73,column:5}},{start:{line:71,column:4},end:{line:73,column:5}}],line:71},"6":{loc:{start:{line:71,column:8},end:{line:71,column:182}},type:"binary-expr",locations:[{start:{line:71,column:8},end:{line:71,column:40}},{start:{line:71,column:44},end:{line:71,column:98}},{start:{line:71,column:102},end:{line:71,column:136}},{start:{line:71,column:140},end:{line:71,column:182}}],line:71}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0,0,0]},_coverageSchema:"d34fc3e6b8297bcde183f5492bcb8fcb36775295"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_ql1ilge0b.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _fileSystem=(cov_ql1ilge0b.s[1]++,require('../../../utilities/fileSystem'));var _fileSystem2=(cov_ql1ilge0b.s[2]++,_interopRequireDefault(_fileSystem));var _filebaseStorage=(cov_ql1ilge0b.s[3]++,require('./filebaseStorage'));var _filebaseStorage2=(cov_ql1ilge0b.s[4]++,_interopRequireDefault(_filebaseStorage));function _interopRequireDefault(obj){cov_ql1ilge0b.f[0]++;cov_ql1ilge0b.s[5]++;return(cov_ql1ilge0b.b[1][0]++,obj)&&(cov_ql1ilge0b.b[1][1]++,obj.__esModule)?(cov_ql1ilge0b.b[0][0]++,obj):(cov_ql1ilge0b.b[0][1]++,{default:obj});}var _ref=(cov_ql1ilge0b.s[6]++,[_fileSystem2.default.deleteFile]),deleteFile=(cov_ql1ilge0b.s[7]++,_ref[0]);// Delete file helper method
var _ref2=(cov_ql1ilge0b.s[8]++,[_filebaseStorage2.default.deleteImageFromStorage]),deleteImageFromStorage=(cov_ql1ilge0b.s[9]++,_ref2[0]);// number validation
cov_ql1ilge0b.s[10]++;var isNumber=function isNumber(n){cov_ql1ilge0b.f[1]++;cov_ql1ilge0b.s[11]++;return!Number.isNaN(parseFloat(n));};cov_ql1ilge0b.s[12]++;var isFloat=function isFloat(n){cov_ql1ilge0b.f[2]++;cov_ql1ilge0b.s[13]++;return(cov_ql1ilge0b.b[2][0]++,Number(n)===n)&&(cov_ql1ilge0b.b[2][1]++,n%1!==0);};var errorHandler=(cov_ql1ilge0b.s[14]++,{createHandlerError:function createHandlerError(error,res,fileName){cov_ql1ilge0b.f[3]++;cov_ql1ilge0b.s[15]++;if(fileName){cov_ql1ilge0b.b[3][0]++;cov_ql1ilge0b.s[16]++;deleteImageFromStorage(fileName);}else{cov_ql1ilge0b.b[3][1]++;}// if file uploads delete it
cov_ql1ilge0b.s[17]++;return res.status(400).send(error);},notFoundHandlerError:function notFoundHandlerError(fieldName,res){cov_ql1ilge0b.f[4]++;cov_ql1ilge0b.s[18]++;return res.status(404).send({message:fieldName+' not found'});},incompleteFieldHandlerError:function incompleteFieldHandlerError(res){cov_ql1ilge0b.f[5]++;cov_ql1ilge0b.s[19]++;return res.status(206).send({message:'Incomplete field'});},fileHandleError:function fileHandleError(res,message){cov_ql1ilge0b.f[6]++;cov_ql1ilge0b.s[20]++;// file type handleError
return res.status(403).json({message:message,error:true});},usernameHandlerError:function usernameHandlerError(res){cov_ql1ilge0b.f[7]++;cov_ql1ilge0b.s[21]++;return res.status(400).send({message:'username already exists'});},emailHandlerError:function emailHandlerError(res){cov_ql1ilge0b.f[8]++;cov_ql1ilge0b.s[22]++;return res.status(400).send({message:'email already exists'});},phoneHandlerError:function phoneHandlerError(res){cov_ql1ilge0b.f[9]++;cov_ql1ilge0b.s[23]++;return res.status(400).send({message:'phone already exists'});},questionHandlerError:function questionHandlerError(res){cov_ql1ilge0b.f[10]++;cov_ql1ilge0b.s[24]++;return res.status(400).send({message:'question already exists'});},userNotPrestentHandlerError:function userNotPrestentHandlerError(res,fileName){cov_ql1ilge0b.f[11]++;cov_ql1ilge0b.s[25]++;if(fileName){cov_ql1ilge0b.b[4][0]++;cov_ql1ilge0b.s[26]++;deleteImageFromStorage(fileName);}else{cov_ql1ilge0b.b[4][1]++;}// if file uploads delete it
cov_ql1ilge0b.s[27]++;return res.status(400).send({message:'user has been removed from the database'});},noTokenHandlerError:function noTokenHandlerError(res){cov_ql1ilge0b.f[12]++;cov_ql1ilge0b.s[28]++;return res.status(401).send({auth:false,message:'No token provided.'});},failedAuthHandlerError:function failedAuthHandlerError(res){cov_ql1ilge0b.f[13]++;cov_ql1ilge0b.s[29]++;return res.status(500).send({auth:false,message:'Failed to authenticate token.'});},parametersHandlerError:function parametersHandlerError(req){cov_ql1ilge0b.f[14]++;cov_ql1ilge0b.s[30]++;if((cov_ql1ilge0b.b[6][0]++,!isNumber(req.params.questionId))||(cov_ql1ilge0b.b[6][1]++,!Number.isInteger(parseInt(req.params.questionId,10)))||(cov_ql1ilge0b.b[6][2]++,req.params.questionId>1000000000)||(cov_ql1ilge0b.b[6][3]++,isFloat(parseFloat(req.params.questionId)))){cov_ql1ilge0b.b[5][0]++;cov_ql1ilge0b.s[31]++;return true;}else{cov_ql1ilge0b.b[5][1]++;}cov_ql1ilge0b.s[32]++;return false;}});cov_ql1ilge0b.s[33]++;exports.default=errorHandler;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVycm9ySGFuZGxlci5qcyJdLCJuYW1lcyI6WyJmc0hlbHBlciIsImRlbGV0ZUZpbGUiLCJpbWFnZVN0b3JhZ2UiLCJkZWxldGVJbWFnZUZyb21TdG9yYWdlIiwiaXNOdW1iZXIiLCJOdW1iZXIiLCJpc05hTiIsInBhcnNlRmxvYXQiLCJuIiwiaXNGbG9hdCIsImVycm9ySGFuZGxlciIsImNyZWF0ZUhhbmRsZXJFcnJvciIsImVycm9yIiwicmVzIiwiZmlsZU5hbWUiLCJzdGF0dXMiLCJzZW5kIiwibm90Rm91bmRIYW5kbGVyRXJyb3IiLCJmaWVsZE5hbWUiLCJtZXNzYWdlIiwiaW5jb21wbGV0ZUZpZWxkSGFuZGxlckVycm9yIiwiZmlsZUhhbmRsZUVycm9yIiwianNvbiIsInVzZXJuYW1lSGFuZGxlckVycm9yIiwiZW1haWxIYW5kbGVyRXJyb3IiLCJwaG9uZUhhbmRsZXJFcnJvciIsInF1ZXN0aW9uSGFuZGxlckVycm9yIiwidXNlck5vdFByZXN0ZW50SGFuZGxlckVycm9yIiwibm9Ub2tlbkhhbmRsZXJFcnJvciIsImF1dGgiLCJmYWlsZWRBdXRoSGFuZGxlckVycm9yIiwicGFyYW1ldGVyc0hhbmRsZXJFcnJvciIsInJlcSIsInBhcmFtcyIsInF1ZXN0aW9uSWQiLCJpc0ludGVnZXIiLCJwYXJzZUludCJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7Ozs7QUFDQTs7Ozs7O1dBRXFCLENBQUNBLHFCQUFTQyxVQUFWLEM7SUFBZEEsVSxZQUFvQzs7WUFDVixDQUFDQywwQkFBYUMsc0JBQWQsQztJQUExQkEsc0I7O0FBRVA7O0FBQ0EsSUFBTUMsV0FBVyxTQUFYQSxRQUFXO0FBQUEsU0FBSyxDQUFDQyxPQUFPQyxLQUFQLENBQWFDLFdBQVdDLENBQVgsQ0FBYixDQUFOO0FBQUEsQ0FBakI7O0FBRUEsSUFBTUMsVUFBVSxTQUFWQSxPQUFVO0FBQUEsU0FBS0osT0FBT0csQ0FBUCxNQUFjQSxDQUFkLElBQW1CQSxJQUFJLENBQUosS0FBVSxDQUFsQztBQUFB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V0MsVUFBWCxHQUF3QixVQUQzQixJQUN5Q3pCLFFBQVFGLFdBQVd5QixJQUFJQyxNQUFKLENBQVdDLFVBQXRCLENBQVIsQ0FEN0MsRUFDeUY7QUFDdkYsYUFBTyxJQUFQO0FBQ0QsS0FBQyxPQUFPLEtBQVA7QUFDSDtBQXpDa0IsQ0FBckI7O2tCQTRDZXhCLFkiLCJmaWxlIjoiZXJyb3JIYW5kbGVyLmpzIiwic291cmNlUm9vdCI6Ii9ob21lL3NvbXRvLzFQcm9qZWN0cy9tZW50b3JzaGlwIHByb2plY3QvU3RhY2tPdmVyZmxvdy1saXRlL3NlcnZlci9zZXJ2ZXIvY29udHJvbGxlcnMvdXRpbGl0aWVzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZzSGVscGVyIGZyb20gJy4uLy4uLy4uL3V0aWxpdGllcy9maWxlU3lzdGVtJztcbmltcG9ydCBpbWFnZVN0b3JhZ2UgZnJvbSAnLi9maWxlYmFzZVN0b3JhZ2UnO1xuXG5jb25zdCBbZGVsZXRlRmlsZV0gPSBbZnNIZWxwZXIuZGVsZXRlRmlsZV07Ly8gRGVsZXRlIGZpbGUgaGVscGVyIG1ldGhvZFxuY29uc3QgW2RlbGV0ZUltYWdlRnJvbVN0b3JhZ2VdID0gW2ltYWdlU3RvcmFnZS5kZWxldGVJbWFnZUZyb21TdG9yYWdlXTtcblxuLy8gbnVtYmVyIHZhbGlkYXRpb25cbmNvbnN0IGlzTnVtYmVyID0gbiA9PiAhTnVtYmVyLmlzTmFOKHBhcnNlRmxvYXQobikpO1xuXG5jb25zdCBpc0Zsb2F0ID0gbiA9PiBOdW1iZXIobikgPT09IG4gJiYgbiAlIDEgIT09IDA7XG5cbmNvbnN0IGVycm9ySGFuZGxlciA9IHtcbiAgY3JlYXRlSGFuZGxlckVycm9yKGVycm9yLCByZXMsIGZpbGVOYW1lKSB7XG4gICAgaWYoZmlsZU5hbWUpIGRlbGV0ZUltYWdlRnJvbVN0b3JhZ2UoZmlsZU5hbWUpOyAvLyBpZiBmaWxlIHVwbG9hZHMgZGVsZXRlIGl0XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGVycm9yKTtcbiAgfSxcbiAgbm90Rm91bmRIYW5kbGVyRXJyb3IoZmllbGROYW1lLCByZXMpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoeyBtZXNzYWdlOiBgJHtmaWVsZE5hbWV9IG5vdCBmb3VuZGAgfSk7XG4gIH0sXG4gIGluY29tcGxldGVGaWVsZEhhbmRsZXJFcnJvcihyZXMpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDYpLnNlbmQoeyBtZXNzYWdlOiAnSW5jb21wbGV0ZSBmaWVsZCcgfSk7XG4gIH0sXG4gIGZpbGVIYW5kbGVFcnJvcihyZXMsIG1lc3NhZ2UpIHsgLy8gZmlsZSB0eXBlIGhhbmRsZUVycm9yXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgbWVzc2FnZTogbWVzc2FnZSwgZXJyb3I6IHRydWUgfSk7XG4gIH0sXG4gIHVzZXJuYW1lSGFuZGxlckVycm9yKHJlcykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IG1lc3NhZ2U6ICd1c2VybmFtZSBhbHJlYWR5IGV4aXN0cycgfSk7XG4gIH0sXG4gIGVtYWlsSGFuZGxlckVycm9yKHJlcykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IG1lc3NhZ2U6ICdlbWFpbCBhbHJlYWR5IGV4aXN0cycgfSk7XG4gIH0sXG4gIHBob25lSGFuZGxlckVycm9yKHJlcykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IG1lc3NhZ2U6ICdwaG9uZSBhbHJlYWR5IGV4aXN0cycgfSk7XG4gIH0sXG4gIHF1ZXN0aW9uSGFuZGxlckVycm9yKHJlcykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IG1lc3NhZ2U6ICdxdWVzdGlvbiBhbHJlYWR5IGV4aXN0cycgfSk7XG4gIH0sXG4gIHVzZXJOb3RQcmVzdGVudEhhbmRsZXJFcnJvcihyZXMsIGZpbGVOYW1lKSB7XG4gICAgaWYoZmlsZU5hbWUpIGRlbGV0ZUltYWdlRnJvbVN0b3JhZ2UoZmlsZU5hbWUpOyAvLyBpZiBmaWxlIHVwbG9hZHMgZGVsZXRlIGl0XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKHsgbWVzc2FnZTogJ3VzZXIgaGFzIGJlZW4gcmVtb3ZlZCBmcm9tIHRoZSBkYXRhYmFzZScgfSk7XG4gIH0sXG4gIG5vVG9rZW5IYW5kbGVyRXJyb3IocmVzKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5zZW5kKHsgYXV0aDogZmFsc2UsIG1lc3NhZ2U6ICdObyB0b2tlbiBwcm92aWRlZC4nIH0pO1xuICB9LFxuICBmYWlsZWRBdXRoSGFuZGxlckVycm9yKHJlcykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZCh7IGF1dGg6IGZhbHNlLCBtZXNzYWdlOiAnRmFpbGVkIHRvIGF1dGhlbnRpY2F0ZSB0b2tlbi4nIH0pO1xuICB9LFxuICBwYXJhbWV0ZXJzSGFuZGxlckVycm9yKHJlcSkge1xuICAgIGlmICghaXNOdW1iZXIocmVxLnBhcmFtcy5xdWVzdGlvbklkKSB8fCAhTnVtYmVyLmlzSW50ZWdlcihwYXJzZUludChyZXEucGFyYW1zLnF1ZXN0aW9uSWQsIDEwKSlcbiAgICAgICAgfHwgcmVxLnBhcmFtcy5xdWVzdGlvbklkID4gMTAwMDAwMDAwMCB8fCBpc0Zsb2F0KHBhcnNlRmxvYXQocmVxLnBhcmFtcy5xdWVzdGlvbklkKSkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gcmV0dXJuIGZhbHNlO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBlcnJvckhhbmRsZXI7XG4iXX0=