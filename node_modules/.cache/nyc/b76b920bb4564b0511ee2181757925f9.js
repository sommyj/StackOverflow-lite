'use strict';var cov_13dazxs0ss=function(){var path="/home/somto/1Projects/mentorship project/StackOverflow-lite/server/server/controllers/utilities/fileFilter.js",hash="298c5e7f3c6d158104a074ae422e14862a316816",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/home/somto/1Projects/mentorship project/StackOverflow-lite/server/server/controllers/utilities/fileFilter.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:18},end:{line:7,column:58}},"2":{start:{line:9,column:19},end:{line:9,column:54}},"3":{start:{line:11,column:39},end:{line:11,column:93}},"4":{start:{line:13,column:17},end:{line:13,column:48}},"5":{start:{line:14,column:17},end:{line:14,column:48}},"6":{start:{line:17,column:23},end:{line:42,column:1}},"7":{start:{line:18,column:23},end:{line:18,column:25}},"8":{start:{line:19,column:22},end:{line:19,column:27}},"9":{start:{line:20,column:22},end:{line:20,column:27}},"10":{start:{line:21,column:17},end:{line:21,column:19}},"11":{start:{line:23,column:2},end:{line:37,column:3}},"12":{start:{line:24,column:19},end:{line:24,column:39}},"13":{start:{line:25,column:21},end:{line:25,column:97}},"14":{start:{line:26,column:4},end:{line:36,column:5}},"15":{start:{line:27,column:6},end:{line:33,column:7}},"16":{start:{line:28,column:8},end:{line:28,column:41}},"17":{start:{line:30,column:8},end:{line:30,column:62}},"18":{start:{line:32,column:8},end:{line:32,column:29}},"19":{start:{line:32,column:29},end:{line:32,column:50}},"20":{start:{line:35,column:6},end:{line:35,column:27}},"21":{start:{line:35,column:27},end:{line:35,column:48}},"22":{start:{line:38,column:2},end:{line:38,column:36}},"23":{start:{line:38,column:36},end:{line:38,column:70}},"24":{start:{line:39,column:2},end:{line:39,column:31}},"25":{start:{line:41,column:2},end:{line:41,column:24}},"26":{start:{line:44,column:0},end:{line:44,column:35}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:11,column:9},end:{line:11,column:31}},loc:{start:{line:11,column:37},end:{line:11,column:95}},line:11},"1":{name:"fileFilterMethod",decl:{start:{line:17,column:32},end:{line:17,column:48}},loc:{start:{line:17,column:81},end:{line:42,column:1}},line:17}},branchMap:{"0":{loc:{start:{line:11,column:46},end:{line:11,column:92}},type:"cond-expr",locations:[{start:{line:11,column:70},end:{line:11,column:73}},{start:{line:11,column:76},end:{line:11,column:92}}],line:11},"1":{loc:{start:{line:11,column:46},end:{line:11,column:67}},type:"binary-expr",locations:[{start:{line:11,column:46},end:{line:11,column:49}},{start:{line:11,column:53},end:{line:11,column:67}}],line:11},"2":{loc:{start:{line:23,column:2},end:{line:37,column:3}},type:"if",locations:[{start:{line:23,column:2},end:{line:37,column:3}},{start:{line:23,column:2},end:{line:37,column:3}}],line:23},"3":{loc:{start:{line:26,column:4},end:{line:36,column:5}},type:"if",locations:[{start:{line:26,column:4},end:{line:36,column:5}},{start:{line:26,column:4},end:{line:36,column:5}}],line:26},"4":{loc:{start:{line:26,column:8},end:{line:26,column:79}},type:"binary-expr",locations:[{start:{line:26,column:8},end:{line:26,column:42}},{start:{line:26,column:46},end:{line:26,column:79}}],line:26},"5":{loc:{start:{line:27,column:6},end:{line:33,column:7}},type:"if",locations:[{start:{line:27,column:6},end:{line:33,column:7}},{start:{line:27,column:6},end:{line:33,column:7}}],line:27}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"d34fc3e6b8297bcde183f5492bcb8fcb36775295"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_13dazxs0ss.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _fileSystem=(cov_13dazxs0ss.s[1]++,require('../../../utilities/fileSystem'));var _fileSystem2=(cov_13dazxs0ss.s[2]++,_interopRequireDefault(_fileSystem));function _interopRequireDefault(obj){cov_13dazxs0ss.f[0]++;cov_13dazxs0ss.s[3]++;return(cov_13dazxs0ss.b[1][0]++,obj)&&(cov_13dazxs0ss.b[1][1]++,obj.__esModule)?(cov_13dazxs0ss.b[0][0]++,obj):(cov_13dazxs0ss.b[0][1]++,{default:obj});}var renameFile=(cov_13dazxs0ss.s[4]++,_fileSystem2.default.renameFile);//Rename file helper method
var deleteFile=(cov_13dazxs0ss.s[5]++,_fileSystem2.default.deleteFile);//Delete file helper method
/* File filter handle method */cov_13dazxs0ss.s[6]++;var fileFilterMethod=function fileFilterMethod(req,fileSizeLimit,folderName){cov_13dazxs0ss.f[1]++;var fileErrorArray=(cov_13dazxs0ss.s[7]++,[]);var fileSizeError=(cov_13dazxs0ss.s[8]++,false),fileTypeError=(cov_13dazxs0ss.s[9]++,false),filePath=(cov_13dazxs0ss.s[10]++,'');cov_13dazxs0ss.s[11]++;if(req.file){cov_13dazxs0ss.b[2][0]++;var tempPath=(cov_13dazxs0ss.s[12]++,'./'+req.file.path);var targetPath=(cov_13dazxs0ss.s[13]++,'./'+folderName+'/'+(new Date().toISOString()+req.file.originalname));cov_13dazxs0ss.s[14]++;if((cov_13dazxs0ss.b[4][0]++,req.file.mimetype==='image/jpeg')||(cov_13dazxs0ss.b[4][1]++,req.file.mimetype==='image/png')){cov_13dazxs0ss.b[3][0]++;cov_13dazxs0ss.s[15]++;if(req.file.size<=fileSizeLimit){cov_13dazxs0ss.b[5][0]++;cov_13dazxs0ss.s[16]++;renameFile(tempPath,targetPath);// remove the dot in targetPath
cov_13dazxs0ss.s[17]++;filePath=targetPath.substring(1,targetPath.length);}else{cov_13dazxs0ss.b[5][1]++;cov_13dazxs0ss.s[18]++;deleteFile(tempPath);cov_13dazxs0ss.s[19]++;fileSizeError=true;}}else{cov_13dazxs0ss.b[3][1]++;cov_13dazxs0ss.s[20]++;deleteFile(tempPath);cov_13dazxs0ss.s[21]++;fileTypeError=true;}}else{cov_13dazxs0ss.b[2][1]++;}cov_13dazxs0ss.s[22]++;fileErrorArray[0]=fileSizeError;cov_13dazxs0ss.s[23]++;fileErrorArray[1]=fileTypeError;cov_13dazxs0ss.s[24]++;fileErrorArray[2]=filePath;cov_13dazxs0ss.s[25]++;return fileErrorArray;};cov_13dazxs0ss.s[26]++;exports.default=fileFilterMethod;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpbGVGaWx0ZXIuanMiXSwibmFtZXMiOlsicmVuYW1lRmlsZSIsImZzSGVscGVyIiwiZGVsZXRlRmlsZSIsImZpbGVGaWx0ZXJNZXRob2QiLCJyZXEiLCJmaWxlU2l6ZUxpbWl0IiwiZm9sZGVyTmFtZSIsImZpbGVFcnJvckFycmF5IiwiZmlsZVNpemVFcnJvciIsImZpbGVUeXBlRXJyb3IiLCJmaWxlUGF0aCIsImZpbGUiLCJ0ZW1wUGF0aCIsInBhdGgiLCJ0YXJnZXRQYXRoIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwib3JpZ2luYWxuYW1lIiwibWltZXR5cGUiLCJzaXplIiwic3Vic3RyaW5nIiwibGVuZ3RoIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7Ozs7O0FBRUEsSUFBTUEsYUFBYUMscUJBQVNELFVBQTVCLEMsQ0FBdUM7QUFDdkMsSUFBTUUsYUFBYUQscUJBQVNDLFVBQTVCLEMsQ0FBdUM7O0FBRXZDO0FBQ0EsSUFBTUMsbUJBQW1CLFNBQW5CQSxnQkFBbUIsQ0FBQ0MsR0FBRCxFQUFNQyxhQUFOLEVBQXFCQyxVQUFyQixFQUFvQztBQUMzRCxNQUFNQyxpQkFBaUIsRUFBdkI7QUFDQSxNQUFJQyxnQkFBZ0IsS0FBcEI7QUFBQSxNQUEyQkMsZ0JBQWdCLEtBQTNDO0FBQUEsTUFBa0RDLFdBQVcsRUFBN0Q7O0FBRUEsTUFBSU4sSUFBSU8sSUFBUixFQUFjO0FBQ1osUUFBTUMsa0JBQWdCUixJQUFJTyxJQUFKLENBQVNFLElBQS9CO0FBQ0EsUUFBTUMsb0JBQWtCUixVQUFsQixVQUFnQyxJQUFJUyxJQUFKLEdBQVdDLFdBQVgsS0FBMkJaLElBQUlPLElBQUosQ0FBU00sWUFBcEUsQ0FBTjtBQUNBLFFBQUliLElBQUlPLElBQUosQ0FBU08sUUFBVCxLQUFzQixZQUF0QixJQUFzQ2QsSUFBSU8sSUFBSixDQUFTTyxRQUFULEtBQXNCLFdBQWhFLEVBQTZFO0FBQzNFLFVBQUlkLElBQUlPLElBQUosQ0FBU1EsSUFBVCxJQUFpQmQsYUFBckIsRUFBb0M7QUFDbENMLG1CQUFXWSxRQUFYLEVBQXFCRSxVQUFyQjtBQUNBO0FBQ0FKLG1CQUFXSSxXQUFXTSxTQUFYLENBQXFCLENBQXJCLEVBQXdCTixXQUFXTyxNQUFuQyxDQUFYO0FBQ0QsT0FKRCxNQUlPO0FBQUVuQixtQkFBV1UsUUFBWCxFQUFzQkosZ0JBQWdCLElBQWhCO0FBQXVCO0FBQ3ZELEtBTkQsTUFNTztBQUFFTixpQkFBV1UsUUFBWCxFQUFzQkgsZ0JBQWdCLElBQWhCO0FBQXVCO0FBQ3ZEO0FBQ0RGLGlCQUFlLENBQWYsSUFBb0JDLGFBQXBCLENBQW1DRCxlQUFlLENBQWYsSUFBb0JFLGFBQXBCO0FBQ25DRixpQkFBZSxDQUFmLElBQW9CRyxRQUFwQjs7QUFFQSxTQUFPSCxjQUFQO0FBQ0QsQ0FuQkQ7O2tCQXFCZUosZ0IiLCJmaWxlIjoiZmlsZUZpbHRlci5qcyIsInNvdXJjZVJvb3QiOiIvaG9tZS9zb210by8xUHJvamVjdHMvbWVudG9yc2hpcCBwcm9qZWN0L1N0YWNrT3ZlcmZsb3ctbGl0ZS9zZXJ2ZXIvc2VydmVyL2NvbnRyb2xsZXJzL3V0aWxpdGllcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmc0hlbHBlciBmcm9tICcuLi8uLi8uLi91dGlsaXRpZXMvZmlsZVN5c3RlbSc7XG5cbmNvbnN0IHJlbmFtZUZpbGUgPSBmc0hlbHBlci5yZW5hbWVGaWxlOy8vUmVuYW1lIGZpbGUgaGVscGVyIG1ldGhvZFxuY29uc3QgZGVsZXRlRmlsZSA9IGZzSGVscGVyLmRlbGV0ZUZpbGU7Ly9EZWxldGUgZmlsZSBoZWxwZXIgbWV0aG9kXG5cbi8qIEZpbGUgZmlsdGVyIGhhbmRsZSBtZXRob2QgKi9cbmNvbnN0IGZpbGVGaWx0ZXJNZXRob2QgPSAocmVxLCBmaWxlU2l6ZUxpbWl0LCBmb2xkZXJOYW1lKSA9PiB7XG4gIGNvbnN0IGZpbGVFcnJvckFycmF5ID0gW107XG4gIGxldCBmaWxlU2l6ZUVycm9yID0gZmFsc2UsIGZpbGVUeXBlRXJyb3IgPSBmYWxzZSwgZmlsZVBhdGggPSAnJztcblxuICBpZiAocmVxLmZpbGUpIHtcbiAgICBjb25zdCB0ZW1wUGF0aCA9IGAuLyR7cmVxLmZpbGUucGF0aH1gO1xuICAgIGNvbnN0IHRhcmdldFBhdGggPSBgLi8ke2ZvbGRlck5hbWV9LyR7bmV3IERhdGUoKS50b0lTT1N0cmluZygpICsgcmVxLmZpbGUub3JpZ2luYWxuYW1lfWA7XG4gICAgaWYgKHJlcS5maWxlLm1pbWV0eXBlID09PSAnaW1hZ2UvanBlZycgfHwgcmVxLmZpbGUubWltZXR5cGUgPT09ICdpbWFnZS9wbmcnKSB7XG4gICAgICBpZiAocmVxLmZpbGUuc2l6ZSA8PSBmaWxlU2l6ZUxpbWl0KSB7XG4gICAgICAgIHJlbmFtZUZpbGUodGVtcFBhdGgsIHRhcmdldFBhdGgpO1xuICAgICAgICAvLyByZW1vdmUgdGhlIGRvdCBpbiB0YXJnZXRQYXRoXG4gICAgICAgIGZpbGVQYXRoID0gdGFyZ2V0UGF0aC5zdWJzdHJpbmcoMSwgdGFyZ2V0UGF0aC5sZW5ndGgpO1xuICAgICAgfSBlbHNlIHsgZGVsZXRlRmlsZSh0ZW1wUGF0aCk7IGZpbGVTaXplRXJyb3IgPSB0cnVlOyB9XG4gICAgfSBlbHNlIHsgZGVsZXRlRmlsZSh0ZW1wUGF0aCk7IGZpbGVUeXBlRXJyb3IgPSB0cnVlOyB9XG4gIH1cbiAgZmlsZUVycm9yQXJyYXlbMF0gPSBmaWxlU2l6ZUVycm9yOyBmaWxlRXJyb3JBcnJheVsxXSA9IGZpbGVUeXBlRXJyb3I7XG4gIGZpbGVFcnJvckFycmF5WzJdID0gZmlsZVBhdGg7XG5cbiAgcmV0dXJuIGZpbGVFcnJvckFycmF5O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgZmlsZUZpbHRlck1ldGhvZDtcbiJdfQ==