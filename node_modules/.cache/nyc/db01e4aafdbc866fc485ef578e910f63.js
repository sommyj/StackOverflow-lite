'use strict';var cov_ql1ilge0b=function(){var path="/home/somto/1Projects/mentorship project/StackOverflow-lite/server/server/controllers/utilities/errorHandler.js",hash="e115c728be4dc88cb211ca81bee95e7c99437d00",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/home/somto/1Projects/mentorship project/StackOverflow-lite/server/server/controllers/utilities/errorHandler.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:23},end:{line:7,column:51}},"2":{start:{line:9,column:24},end:{line:9,column:64}},"3":{start:{line:11,column:39},end:{line:11,column:93}},"4":{start:{line:13,column:11},end:{line:13,column:32}},"5":{start:{line:14,column:17},end:{line:14,column:24}},"6":{start:{line:16,column:12},end:{line:16,column:62}},"7":{start:{line:17,column:29},end:{line:17,column:37}},"8":{start:{line:21,column:15},end:{line:23,column:1}},"9":{start:{line:22,column:2},end:{line:22,column:38}},"10":{start:{line:25,column:14},end:{line:27,column:1}},"11":{start:{line:26,column:2},end:{line:26,column:40}},"12":{start:{line:29,column:19},end:{line:71,column:1}},"13":{start:{line:31,column:4},end:{line:31,column:51}},"14":{start:{line:31,column:18},end:{line:31,column:51}},"15":{start:{line:32,column:4},end:{line:32,column:39}},"16":{start:{line:35,column:4},end:{line:35,column:71}},"17":{start:{line:38,column:4},end:{line:38,column:65}},"18":{start:{line:42,column:4},end:{line:42,column:67}},"19":{start:{line:45,column:4},end:{line:45,column:72}},"20":{start:{line:48,column:4},end:{line:48,column:69}},"21":{start:{line:51,column:4},end:{line:51,column:69}},"22":{start:{line:54,column:4},end:{line:54,column:72}},"23":{start:{line:57,column:4},end:{line:57,column:51}},"24":{start:{line:57,column:18},end:{line:57,column:51}},"25":{start:{line:58,column:4},end:{line:58,column:88}},"26":{start:{line:61,column:4},end:{line:61,column:80}},"27":{start:{line:64,column:4},end:{line:64,column:91}},"28":{start:{line:67,column:4},end:{line:69,column:5}},"29":{start:{line:68,column:6},end:{line:68,column:18}},"30":{start:{line:69,column:5},end:{line:69,column:18}},"31":{start:{line:73,column:0},end:{line:73,column:31}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:11,column:9},end:{line:11,column:31}},loc:{start:{line:11,column:37},end:{line:11,column:95}},line:11},"1":{name:"isNumber",decl:{start:{line:21,column:24},end:{line:21,column:32}},loc:{start:{line:21,column:36},end:{line:23,column:1}},line:21},"2":{name:"isFloat",decl:{start:{line:25,column:23},end:{line:25,column:30}},loc:{start:{line:25,column:34},end:{line:27,column:1}},line:25},"3":{name:"createHandlerError",decl:{start:{line:30,column:31},end:{line:30,column:49}},loc:{start:{line:30,column:72},end:{line:33,column:3}},line:30},"4":{name:"notFoundHandlerError",decl:{start:{line:34,column:33},end:{line:34,column:53}},loc:{start:{line:34,column:70},end:{line:36,column:3}},line:34},"5":{name:"incompleteFieldHandlerError",decl:{start:{line:37,column:40},end:{line:37,column:67}},loc:{start:{line:37,column:73},end:{line:39,column:3}},line:37},"6":{name:"fileHandleError",decl:{start:{line:40,column:28},end:{line:40,column:43}},loc:{start:{line:40,column:58},end:{line:43,column:3}},line:40},"7":{name:"usernameHandlerError",decl:{start:{line:44,column:33},end:{line:44,column:53}},loc:{start:{line:44,column:59},end:{line:46,column:3}},line:44},"8":{name:"emailHandlerError",decl:{start:{line:47,column:30},end:{line:47,column:47}},loc:{start:{line:47,column:53},end:{line:49,column:3}},line:47},"9":{name:"phoneHandlerError",decl:{start:{line:50,column:30},end:{line:50,column:47}},loc:{start:{line:50,column:53},end:{line:52,column:3}},line:50},"10":{name:"questionHandlerError",decl:{start:{line:53,column:33},end:{line:53,column:53}},loc:{start:{line:53,column:59},end:{line:55,column:3}},line:53},"11":{name:"userNotPrestentHandlerError",decl:{start:{line:56,column:40},end:{line:56,column:67}},loc:{start:{line:56,column:83},end:{line:59,column:3}},line:56},"12":{name:"noTokenHandlerError",decl:{start:{line:60,column:32},end:{line:60,column:51}},loc:{start:{line:60,column:57},end:{line:62,column:3}},line:60},"13":{name:"failedAuthHandlerError",decl:{start:{line:63,column:35},end:{line:63,column:57}},loc:{start:{line:63,column:63},end:{line:65,column:3}},line:63},"14":{name:"parametersHandlerError",decl:{start:{line:66,column:35},end:{line:66,column:57}},loc:{start:{line:66,column:63},end:{line:70,column:3}},line:66}},branchMap:{"0":{loc:{start:{line:11,column:46},end:{line:11,column:92}},type:"cond-expr",locations:[{start:{line:11,column:70},end:{line:11,column:73}},{start:{line:11,column:76},end:{line:11,column:92}}],line:11},"1":{loc:{start:{line:11,column:46},end:{line:11,column:67}},type:"binary-expr",locations:[{start:{line:11,column:46},end:{line:11,column:49}},{start:{line:11,column:53},end:{line:11,column:67}}],line:11},"2":{loc:{start:{line:26,column:9},end:{line:26,column:39}},type:"binary-expr",locations:[{start:{line:26,column:9},end:{line:26,column:24}},{start:{line:26,column:28},end:{line:26,column:39}}],line:26},"3":{loc:{start:{line:31,column:4},end:{line:31,column:51}},type:"if",locations:[{start:{line:31,column:4},end:{line:31,column:51}},{start:{line:31,column:4},end:{line:31,column:51}}],line:31},"4":{loc:{start:{line:57,column:4},end:{line:57,column:51}},type:"if",locations:[{start:{line:57,column:4},end:{line:57,column:51}},{start:{line:57,column:4},end:{line:57,column:51}}],line:57},"5":{loc:{start:{line:67,column:4},end:{line:69,column:5}},type:"if",locations:[{start:{line:67,column:4},end:{line:69,column:5}},{start:{line:67,column:4},end:{line:69,column:5}}],line:67},"6":{loc:{start:{line:67,column:8},end:{line:67,column:182}},type:"binary-expr",locations:[{start:{line:67,column:8},end:{line:67,column:40}},{start:{line:67,column:44},end:{line:67,column:98}},{start:{line:67,column:102},end:{line:67,column:136}},{start:{line:67,column:140},end:{line:67,column:182}}],line:67}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0,0,0]},_coverageSchema:"d34fc3e6b8297bcde183f5492bcb8fcb36775295"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_ql1ilge0b.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _filebaseStorage=(cov_ql1ilge0b.s[1]++,require('./filebaseStorage'));var _filebaseStorage2=(cov_ql1ilge0b.s[2]++,_interopRequireDefault(_filebaseStorage));function _interopRequireDefault(obj){cov_ql1ilge0b.f[0]++;cov_ql1ilge0b.s[3]++;return(cov_ql1ilge0b.b[1][0]++,obj)&&(cov_ql1ilge0b.b[1][1]++,obj.__esModule)?(cov_ql1ilge0b.b[0][0]++,obj):(cov_ql1ilge0b.b[0][1]++,{default:obj});}var _ref=(cov_ql1ilge0b.s[4]++,[fsHelper.deleteFile]),deleteFile=(cov_ql1ilge0b.s[5]++,_ref[0]);// Delete file helper method
var _ref2=(cov_ql1ilge0b.s[6]++,[_filebaseStorage2.default.deleteImageFromStorage]),deleteImageFromStorage=(cov_ql1ilge0b.s[7]++,_ref2[0]);// number validation
cov_ql1ilge0b.s[8]++;var isNumber=function isNumber(n){cov_ql1ilge0b.f[1]++;cov_ql1ilge0b.s[9]++;return!Number.isNaN(parseFloat(n));};cov_ql1ilge0b.s[10]++;var isFloat=function isFloat(n){cov_ql1ilge0b.f[2]++;cov_ql1ilge0b.s[11]++;return(cov_ql1ilge0b.b[2][0]++,Number(n)===n)&&(cov_ql1ilge0b.b[2][1]++,n%1!==0);};var errorHandler=(cov_ql1ilge0b.s[12]++,{createHandlerError:function createHandlerError(error,res,fileName){cov_ql1ilge0b.f[3]++;cov_ql1ilge0b.s[13]++;if(fileName){cov_ql1ilge0b.b[3][0]++;cov_ql1ilge0b.s[14]++;deleteImageFromStorage(fileName);}else{cov_ql1ilge0b.b[3][1]++;}// if file uploads delete it
cov_ql1ilge0b.s[15]++;return res.status(400).send(error);},notFoundHandlerError:function notFoundHandlerError(fieldName,res){cov_ql1ilge0b.f[4]++;cov_ql1ilge0b.s[16]++;return res.status(404).send({message:fieldName+' not found'});},incompleteFieldHandlerError:function incompleteFieldHandlerError(res){cov_ql1ilge0b.f[5]++;cov_ql1ilge0b.s[17]++;return res.status(206).send({message:'Incomplete field'});},fileHandleError:function fileHandleError(res,message){cov_ql1ilge0b.f[6]++;cov_ql1ilge0b.s[18]++;// file type handleError
return res.status(403).json({message:message,error:true});},usernameHandlerError:function usernameHandlerError(res){cov_ql1ilge0b.f[7]++;cov_ql1ilge0b.s[19]++;return res.status(400).send({message:'username already exists'});},emailHandlerError:function emailHandlerError(res){cov_ql1ilge0b.f[8]++;cov_ql1ilge0b.s[20]++;return res.status(400).send({message:'email already exists'});},phoneHandlerError:function phoneHandlerError(res){cov_ql1ilge0b.f[9]++;cov_ql1ilge0b.s[21]++;return res.status(400).send({message:'phone already exists'});},questionHandlerError:function questionHandlerError(res){cov_ql1ilge0b.f[10]++;cov_ql1ilge0b.s[22]++;return res.status(400).send({message:'question already exists'});},userNotPrestentHandlerError:function userNotPrestentHandlerError(res,fileName){cov_ql1ilge0b.f[11]++;cov_ql1ilge0b.s[23]++;if(fileName){cov_ql1ilge0b.b[4][0]++;cov_ql1ilge0b.s[24]++;deleteImageFromStorage(fileName);}else{cov_ql1ilge0b.b[4][1]++;}// if file uploads delete it
cov_ql1ilge0b.s[25]++;return res.status(400).send({message:'user has been removed from the database'});},noTokenHandlerError:function noTokenHandlerError(res){cov_ql1ilge0b.f[12]++;cov_ql1ilge0b.s[26]++;return res.status(401).send({auth:false,message:'No token provided.'});},failedAuthHandlerError:function failedAuthHandlerError(res){cov_ql1ilge0b.f[13]++;cov_ql1ilge0b.s[27]++;return res.status(500).send({auth:false,message:'Failed to authenticate token.'});},parametersHandlerError:function parametersHandlerError(req){cov_ql1ilge0b.f[14]++;cov_ql1ilge0b.s[28]++;if((cov_ql1ilge0b.b[6][0]++,!isNumber(req.params.questionId))||(cov_ql1ilge0b.b[6][1]++,!Number.isInteger(parseInt(req.params.questionId,10)))||(cov_ql1ilge0b.b[6][2]++,req.params.questionId>1000000000)||(cov_ql1ilge0b.b[6][3]++,isFloat(parseFloat(req.params.questionId)))){cov_ql1ilge0b.b[5][0]++;cov_ql1ilge0b.s[29]++;return true;}else{cov_ql1ilge0b.b[5][1]++;}cov_ql1ilge0b.s[30]++;return false;}});cov_ql1ilge0b.s[31]++;exports.default=errorHandler;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVycm9ySGFuZGxlci5qcyJdLCJuYW1lcyI6WyJmc0hlbHBlciIsImRlbGV0ZUZpbGUiLCJpbWFnZVN0b3JhZ2UiLCJkZWxldGVJbWFnZUZyb21TdG9yYWdlIiwiaXNOdW1iZXIiLCJOdW1iZXIiLCJpc05hTiIsInBhcnNlRmxvYXQiLCJuIiwiaXNGbG9hdCIsImVycm9ySGFuZGxlciIsImNyZWF0ZUhhbmRsZXJFcnJvciIsImVycm9yIiwicmVzIiwiZmlsZU5hbWUiLCJzdGF0dXMiLCJzZW5kIiwibm90Rm91bmRIYW5kbGVyRXJyb3IiLCJmaWVsZE5hbWUiLCJtZXNzYWdlIiwiaW5jb21wbGV0ZUZpZWxkSGFuZGxlckVycm9yIiwiZmlsZUhhbmRsZUVycm9yIiwianNvbiIsInVzZXJuYW1lSGFuZGxlckVycm9yIiwiZW1haWxIYW5kbGVyRXJyb3IiLCJwaG9uZUhhbmRsZXJFcnJvciIsInF1ZXN0aW9uSGFuZGxlckVycm9yIiwidXNlck5vdFByZXN0ZW50SGFuZGxlckVycm9yIiwibm9Ub2tlbkhhbmRsZXJFcnJvciIsImF1dGgiLCJmYWlsZWRBdXRoSGFuZGxlckVycm9yIiwicGFyYW1ldGVyc0hhbmRsZXJFcnJvciIsInJlcSIsInBhcmFtcyIsInF1ZXN0aW9uSWQiLCJpc0ludGVnZXIiLCJwYXJzZUludCJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7Ozs7OztXQUVxQixDQUFDQSxTQUFTQyxVQUFWLEM7SUFBZEEsVSxZQUFvQzs7WUFDVixDQUFDQywwQkFBYUMsc0JBQWQsQztJQUExQkEsc0I7O0FBRVA7O0FBQ0EsSUFBTUMsV0FBVyxTQUFYQSxRQUFXO0FBQUEsU0FBSyxDQUFDQyxPQUFPQyxLQUFQLENBQWFDLFdBQVdDLENBQVgsQ0FBYixDQUFOO0FBQUEsQ0FBakI7O0FBRUEsSUFBTUMsVUFBVSxTQUFWQSxPQUFVO0FBQUEsU0FBS0osT0FBT0csQ0FBUCxNQUFjQSxDQUFkLElBQW1CQSxJQUFJLENBQUosS0FBVSxDQUFsQztBQUFBLENBQWhCOztB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QUF3QixVQUQzQixJQUN5Q3pCLFFBQVFGLFdBQVd5QixJQUFJQyxNQUFKLENBQVdDLFVBQXRCLENBQVIsQ0FEN0MsRUFDeUY7QUFDdkYsYUFBTyxJQUFQO0FBQ0QsS0FBQyxPQUFPLEtBQVA7QUFDSDtBQXpDa0IsQ0FBckI7O2tCQTRDZXhCLFkiLCJmaWxlIjoiZXJyb3JIYW5kbGVyLmpzIiwic291cmNlUm9vdCI6Ii9ob21lL3NvbXRvLzFQcm9qZWN0cy9tZW50b3JzaGlwIHByb2plY3QvU3RhY2tPdmVyZmxvdy1saXRlL3NlcnZlci9zZXJ2ZXIvY29udHJvbGxlcnMvdXRpbGl0aWVzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGltYWdlU3RvcmFnZSBmcm9tICcuL2ZpbGViYXNlU3RvcmFnZSc7XG5cbmNvbnN0IFtkZWxldGVGaWxlXSA9IFtmc0hlbHBlci5kZWxldGVGaWxlXTsvLyBEZWxldGUgZmlsZSBoZWxwZXIgbWV0aG9kXG5jb25zdCBbZGVsZXRlSW1hZ2VGcm9tU3RvcmFnZV0gPSBbaW1hZ2VTdG9yYWdlLmRlbGV0ZUltYWdlRnJvbVN0b3JhZ2VdO1xuXG4vLyBudW1iZXIgdmFsaWRhdGlvblxuY29uc3QgaXNOdW1iZXIgPSBuID0+ICFOdW1iZXIuaXNOYU4ocGFyc2VGbG9hdChuKSk7XG5cbmNvbnN0IGlzRmxvYXQgPSBuID0+IE51bWJlcihuKSA9PT0gbiAmJiBuICUgMSAhPT0gMDtcblxuY29uc3QgZXJyb3JIYW5kbGVyID0ge1xuICBjcmVhdGVIYW5kbGVyRXJyb3IoZXJyb3IsIHJlcywgZmlsZU5hbWUpIHtcbiAgICBpZihmaWxlTmFtZSkgZGVsZXRlSW1hZ2VGcm9tU3RvcmFnZShmaWxlTmFtZSk7IC8vIGlmIGZpbGUgdXBsb2FkcyBkZWxldGUgaXRcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3IpO1xuICB9LFxuICBub3RGb3VuZEhhbmRsZXJFcnJvcihmaWVsZE5hbWUsIHJlcykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCh7IG1lc3NhZ2U6IGAke2ZpZWxkTmFtZX0gbm90IGZvdW5kYCB9KTtcbiAgfSxcbiAgaW5jb21wbGV0ZUZpZWxkSGFuZGxlckVycm9yKHJlcykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDIwNikuc2VuZCh7IG1lc3NhZ2U6ICdJbmNvbXBsZXRlIGZpZWxkJyB9KTtcbiAgfSxcbiAgZmlsZUhhbmRsZUVycm9yKHJlcywgbWVzc2FnZSkgeyAvLyBmaWxlIHR5cGUgaGFuZGxlRXJyb3JcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLmpzb24oeyBtZXNzYWdlOiBtZXNzYWdlLCBlcnJvcjogdHJ1ZSB9KTtcbiAgfSxcbiAgdXNlcm5hbWVIYW5kbGVyRXJyb3IocmVzKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKHsgbWVzc2FnZTogJ3VzZXJuYW1lIGFscmVhZHkgZXhpc3RzJyB9KTtcbiAgfSxcbiAgZW1haWxIYW5kbGVyRXJyb3IocmVzKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKHsgbWVzc2FnZTogJ2VtYWlsIGFscmVhZHkgZXhpc3RzJyB9KTtcbiAgfSxcbiAgcGhvbmVIYW5kbGVyRXJyb3IocmVzKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKHsgbWVzc2FnZTogJ3Bob25lIGFscmVhZHkgZXhpc3RzJyB9KTtcbiAgfSxcbiAgcXVlc3Rpb25IYW5kbGVyRXJyb3IocmVzKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKHsgbWVzc2FnZTogJ3F1ZXN0aW9uIGFscmVhZHkgZXhpc3RzJyB9KTtcbiAgfSxcbiAgdXNlck5vdFByZXN0ZW50SGFuZGxlckVycm9yKHJlcywgZmlsZU5hbWUpIHtcbiAgICBpZihmaWxlTmFtZSkgZGVsZXRlSW1hZ2VGcm9tU3RvcmFnZShmaWxlTmFtZSk7IC8vIGlmIGZpbGUgdXBsb2FkcyBkZWxldGUgaXRcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoeyBtZXNzYWdlOiAndXNlciBoYXMgYmVlbiByZW1vdmVkIGZyb20gdGhlIGRhdGFiYXNlJyB9KTtcbiAgfSxcbiAgbm9Ub2tlbkhhbmRsZXJFcnJvcihyZXMpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLnNlbmQoeyBhdXRoOiBmYWxzZSwgbWVzc2FnZTogJ05vIHRva2VuIHByb3ZpZGVkLicgfSk7XG4gIH0sXG4gIGZhaWxlZEF1dGhIYW5kbGVyRXJyb3IocmVzKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgYXV0aDogZmFsc2UsIG1lc3NhZ2U6ICdGYWlsZWQgdG8gYXV0aGVudGljYXRlIHRva2VuLicgfSk7XG4gIH0sXG4gIHBhcmFtZXRlcnNIYW5kbGVyRXJyb3IocmVxKSB7XG4gICAgaWYgKCFpc051bWJlcihyZXEucGFyYW1zLnF1ZXN0aW9uSWQpIHx8ICFOdW1iZXIuaXNJbnRlZ2VyKHBhcnNlSW50KHJlcS5wYXJhbXMucXVlc3Rpb25JZCwgMTApKVxuICAgICAgICB8fCByZXEucGFyYW1zLnF1ZXN0aW9uSWQgPiAxMDAwMDAwMDAwIHx8IGlzRmxvYXQocGFyc2VGbG9hdChyZXEucGFyYW1zLnF1ZXN0aW9uSWQpKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSByZXR1cm4gZmFsc2U7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IGVycm9ySGFuZGxlcjtcbiJdfQ==