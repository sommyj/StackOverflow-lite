{"version":3,"sources":["fileFilter.js"],"names":["renameFile","fsHelper","deleteFile","fileFilterMethod","req","fileSizeLimit","folderName","fileErrorArray","fileSizeError","fileTypeError","filePath","file","tempPath","path","targetPath","Date","toISOString","originalname","mimetype","size","substring","length"],"mappings":";;;;;;AAAA;;;;;;AAEA,IAAMA,aAAaC,qBAASD,UAA5B,C,CAAuC;AACvC,IAAME,aAAaD,qBAASC,UAA5B,C,CAAuC;;AAEvC;AACA,IAAMC,mBAAmB,SAAnBA,gBAAmB,CAACC,GAAD,EAAMC,aAAN,EAAqBC,UAArB,EAAoC;AAC3D,MAAMC,iBAAiB,EAAvB;AACA,MAAIC,gBAAgB,KAApB;AAAA,MAA2BC,gBAAgB,KAA3C;AAAA,MAAkDC,WAAW,EAA7D;;AAEA,MAAIN,IAAIO,IAAR,EAAc;AACZ,QAAMC,kBAAgBR,IAAIO,IAAJ,CAASE,IAA/B;AACA,QAAMC,oBAAkBR,UAAlB,UAAgC,IAAIS,IAAJ,GAAWC,WAAX,KAA2BZ,IAAIO,IAAJ,CAASM,YAApE,CAAN;AACA,QAAIb,IAAIO,IAAJ,CAASO,QAAT,KAAsB,YAAtB,IAAsCd,IAAIO,IAAJ,CAASO,QAAT,KAAsB,WAAhE,EAA6E;AAC3E,UAAId,IAAIO,IAAJ,CAASQ,IAAT,IAAiBd,aAArB,EAAoC;AAClCL,mBAAWY,QAAX,EAAqBE,UAArB;AACA;AACAJ,mBAAWI,WAAWM,SAAX,CAAqB,CAArB,EAAwBN,WAAWO,MAAnC,CAAX;AACD,OAJD,MAIO;AAAEnB,mBAAWU,QAAX,EAAsBJ,gBAAgB,IAAhB;AAAuB;AACvD,KAND,MAMO;AAAEN,iBAAWU,QAAX,EAAsBH,gBAAgB,IAAhB;AAAuB;AACvD;AACDF,iBAAe,CAAf,IAAoBC,aAApB,CAAmCD,eAAe,CAAf,IAAoBE,aAApB;AACnCF,iBAAe,CAAf,IAAoBG,QAApB;;AAEA,SAAOH,cAAP;AACD,CAnBD;;kBAqBeJ,gB","file":"fileFilter.js","sourceRoot":"/home/somto/1Projects/mentorship project/StackOverflow-lite/server/server/controllers/utilities","sourcesContent":["import fsHelper from '../../../utilities/fileSystem';\n\nconst renameFile = fsHelper.renameFile;//Rename file helper method\nconst deleteFile = fsHelper.deleteFile;//Delete file helper method\n\n/* File filter handle method */\nconst fileFilterMethod = (req, fileSizeLimit, folderName) => {\n  const fileErrorArray = [];\n  let fileSizeError = false, fileTypeError = false, filePath = '';\n\n  if (req.file) {\n    const tempPath = `./${req.file.path}`;\n    const targetPath = `./${folderName}/${new Date().toISOString() + req.file.originalname}`;\n    if (req.file.mimetype === 'image/jpeg' || req.file.mimetype === 'image/png') {\n      if (req.file.size <= fileSizeLimit) {\n        renameFile(tempPath, targetPath);\n        // remove the dot in targetPath\n        filePath = targetPath.substring(1, targetPath.length);\n      } else { deleteFile(tempPath); fileSizeError = true; }\n    } else { deleteFile(tempPath); fileTypeError = true; }\n  }\n  fileErrorArray[0] = fileSizeError; fileErrorArray[1] = fileTypeError;\n  fileErrorArray[2] = filePath;\n\n  return fileErrorArray;\n};\n\nexport default fileFilterMethod;\n"]}